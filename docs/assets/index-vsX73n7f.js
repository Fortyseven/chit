var Be=Object.defineProperty;var De=(e,t,n)=>t in e?Be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ce=(e,t,n)=>(De(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function b(){}const Le=e=>e;function Ce(e){return e()}function ye(){return Object.create(null)}function N(e){e.forEach(Ce)}function oe(e){return typeof e=="function"}function M(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Fe(e){return Object.keys(e).length===0}function me(e,...t){if(e==null){for(const s of t)s(void 0);return b}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function Ne(e){let t;return me(e,n=>t=n)(),t}function Y(e,t,n){e.$$.on_destroy.push(me(t,n))}function Ke(e,t,n){return e.set(n),t}const Me=typeof window<"u";let Je=Me?()=>window.performance.now():()=>Date.now(),he=Me?e=>requestAnimationFrame(e):b;const z=new Set;function je(e){z.forEach(t=>{t.c(e)||(z.delete(t),t.f())}),z.size!==0&&he(je)}function He(e){let t;return z.size===0&&he(je),{promise:new Promise(n=>{z.add(t={c:e,f:n})}),abort(){z.delete(t)}}}function h(e,t){e.appendChild(t)}function Ae(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function Ue(e){const t=_("style");return t.textContent="/* empty */",Ve(Ae(e),t),t.sheet}function Ve(e,t){return h(e.head||e,t),t.sheet}function L(e,t,n){e.insertBefore(t,n||null)}function E(e){e.parentNode&&e.parentNode.removeChild(e)}function Ie(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function _(e){return document.createElement(e)}function F(e){return document.createTextNode(e)}function C(){return F(" ")}function Xe(){return F("")}function ee(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function g(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ge(e){return Array.from(e.childNodes)}function ie(e,t){t=""+t,e.data!==t&&(e.data=t)}function $e(e,t,n){e.classList.toggle(t,!!n)}function Qe(e,t,{bubbles:n=!1,cancelable:s=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:s})}const te=new Map;let ne=0;function We(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function Ye(e,t){const n={stylesheet:Ue(t),rules:{}};return te.set(e,n),n}function be(e,t,n,s,r,o,i,l=0){const u=16.666/s;let c=`{
`;for(let v=0;v<=1;v+=u){const $=t+(n-t)*o(v);c+=v*100+`%{${i($,1-$)}}
`}const f=c+`100% {${i(n,1-n)}}
}`,a=`__svelte_${We(f)}_${l}`,y=Ae(e),{stylesheet:w,rules:p}=te.get(y)||Ye(y,e);p[a]||(p[a]=!0,w.insertRule(`@keyframes ${a} ${f}`,w.cssRules.length));const k=e.style.animation||"";return e.style.animation=`${k?`${k}, `:""}${a} ${s}ms linear ${r}ms 1 both`,ne+=1,a}function Ze(e,t){const n=(e.style.animation||"").split(", "),s=n.filter(t?o=>o.indexOf(t)<0:o=>o.indexOf("__svelte")===-1),r=n.length-s.length;r&&(e.style.animation=s.join(", "),ne-=r,ne||et())}function et(){he(()=>{ne||(te.forEach(e=>{const{ownerNode:t}=e.stylesheet;t&&E(t)}),te.clear())})}let G;function U(e){G=e}function tt(){if(!G)throw new Error("Function called outside component initialization");return G}function Pe(e){tt().$$.on_mount.push(e)}const P=[],fe=[];let T=[];const ve=[],nt=Promise.resolve();let de=!1;function st(){de||(de=!0,nt.then(ze))}function Q(e){T.push(e)}const ue=new Set;let A=0;function ze(){if(A!==0)return;const e=G;do{try{for(;A<P.length;){const t=P[A];A++,U(t),rt(t.$$)}}catch(t){throw P.length=0,A=0,t}for(U(null),P.length=0,A=0;fe.length;)fe.pop()();for(let t=0;t<T.length;t+=1){const n=T[t];ue.has(n)||(ue.add(n),n())}T.length=0}while(P.length);for(;ve.length;)ve.pop()();de=!1,ue.clear(),U(e)}function rt(e){if(e.fragment!==null){e.update(),N(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Q)}}function ot(e){const t=[],n=[];T.forEach(s=>e.indexOf(s)===-1?t.push(s):n.push(s)),n.forEach(s=>s()),T=t}let H;function it(){return H||(H=Promise.resolve(),H.then(()=>{H=null})),H}function ae(e,t,n){e.dispatchEvent(Qe(`${t?"intro":"outro"}${n}`))}const Z=new Set;let pe;function R(e,t){e&&e.i&&(Z.delete(e),e.i(t))}function V(e,t,n,s){if(e&&e.o){if(Z.has(e))return;Z.add(e),pe.c.push(()=>{Z.delete(e),s&&(n&&e.d(1),s())}),e.o(t)}else s&&s()}const lt={duration:0};function we(e,t,n,s){let o=t(e,n,{direction:"both"}),i=s?0:1,l=null,u=null,c=null,f;function a(){c&&Ze(e,c)}function y(p,k){const v=p.b-i;return k*=Math.abs(v),{a:i,b:p.b,d:v,duration:k,start:p.start,end:p.start+k,group:p.group}}function w(p){const{delay:k=0,duration:v=300,easing:$=Le,tick:j=b,css:m}=o||lt,O={start:Je()+k,b:p};p||(O.group=pe,pe.r+=1),"inert"in e&&(p?f!==void 0&&(e.inert=f):(f=e.inert,e.inert=!0)),l||u?u=O:(m&&(a(),c=be(e,i,p,v,k,$,m)),p&&j(0,1),l=y(O,v),Q(()=>ae(e,p,"start")),He(x=>{if(u&&x>u.start&&(l=y(u,v),u=null,ae(e,l.b,"start"),m&&(a(),c=be(e,i,l.b,l.duration,0,$,o.css))),l){if(x>=l.end)j(i=l.b,1-i),ae(e,l.b,"end"),u||(l.b?a():--l.group.r||N(l.group.c)),l=null;else if(x>=l.start){const S=x-l.start;i=l.a+l.d*$(S/l.duration),j(i,1-i)}}return!!(l||u)}))}return{run(p){oe(o)?it().then(()=>{o=o({direction:p?"in":"out"}),w(p)}):w(p)},end(){a(),l=u=null}}}function se(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function X(e){e&&e.c()}function q(e,t,n){const{fragment:s,after_update:r}=e.$$;s&&s.m(t,n),Q(()=>{const o=e.$$.on_mount.map(Ce).filter(oe);e.$$.on_destroy?e.$$.on_destroy.push(...o):N(o),e.$$.on_mount=[]}),r.forEach(Q)}function B(e,t){const n=e.$$;n.fragment!==null&&(ot(n.after_update),N(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ct(e,t){e.$$.dirty[0]===-1&&(P.push(e),st(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function K(e,t,n,s,r,o,i=null,l=[-1]){const u=G;U(e);const c=e.$$={fragment:null,ctx:[],props:o,update:b,not_equal:r,bound:ye(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:ye(),dirty:l,skip_bound:!1,root:t.target||u.$$.root};i&&i(c.root);let f=!1;if(c.ctx=n?n(e,t.props||{},(a,y,...w)=>{const p=w.length?w[0]:y;return c.ctx&&r(c.ctx[a],c.ctx[a]=p)&&(!c.skip_bound&&c.bound[a]&&c.bound[a](p),f&&ct(e,a)),y}):[],c.update(),f=!0,N(c.before_update),c.fragment=s?s(c.ctx):!1,t.target){if(t.hydrate){const a=Ge(t.target);c.fragment&&c.fragment.l(a),a.forEach(E)}else c.fragment&&c.fragment.c();t.intro&&R(e.$$.fragment),q(e,t.target,t.anchor),ze()}U(u)}class J{constructor(){ce(this,"$$");ce(this,"$$set")}$destroy(){B(this,1),this.$destroy=b}$on(t,n){if(!oe(n))return b;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const r=s.indexOf(n);r!==-1&&s.splice(r,1)}}$set(t){this.$$set&&!Fe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ut="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ut);const I=[];function at(e,t){return{subscribe:d(e,t).subscribe}}function d(e,t=b){let n;const s=new Set;function r(l){if(M(e,l)&&(e=l,n)){const u=!I.length;for(const c of s)c[1](),I.push(c,e);if(u){for(let c=0;c<I.length;c+=2)I[c][0](I[c+1]);I.length=0}}}function o(l){r(l(e))}function i(l,u=b){const c=[l,u];return s.add(c),s.size===1&&(n=t(r,o)||b),l(e),()=>{s.delete(c),s.size===0&&n&&(n(),n=null)}}return{set:r,update:o,subscribe:i}}function ft(e,t,n){const s=!Array.isArray(e),r=s?[e]:e;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=t.length<2;return at(n,(i,l)=>{let u=!1;const c=[];let f=0,a=b;const y=()=>{if(f)return;a();const p=t(s?c[0]:c,i,l);o?i(p):a=oe(p)?p:b},w=r.map((p,k)=>me(p,v=>{c[k]=v,f&=~(1<<k),u&&y()},()=>{f|=1<<k}));return u=!0,y(),function(){N(w),a(),u=!1}})}let W=d([]),re=d(0),le=d([]),dt={embeddingonly:d(!1),f16kv:d(!0),frequencypenalty:d(1),lowvram:d(!1),maingpu:d(0),mirostat:d(1),mirostateta:d(.6),mirostattau:d(.8),numbatch:d(2),numctx:d(1024),numgpu:d(1),numgqa:d(1),numkeep:d(5),numpredict:d(100),numthread:d(8),numa:d(!1),penalizenewline:d(!0),presencepenalty:d(1.5),repeatlastn:d(33),repeatpenalty:d(1.2),ropefrequencybase:d(1.1),ropefrequencyscale:d(.8),seed:d(42),stop:d([`
`,"user:"]),temperature:d(.8),tfsz:d(.5),topk:d(20),topp:d(.9),typicalp:d(.7),usemlock:d(!1),usemmap:d(!0),vocabonly:d(!1)};const ge=ft([W,re],([e,t])=>e[t]),D=Object.freeze(Object.defineProperty({__proto__:null,chatTimeline:le,currentModel:ge,currentModelIndex:re,model_settings:dt,models:W},Symbol.toStringTag,{value:"Module"}));function ke(e,t,n){const s=e.slice();return s[1]=t[n],s}function pt(e){let t,n=e[1].content+"",s,r;return{c(){t=_("div"),s=F(n),r=C(),g(t,"class","bot svelte-kyf5i9")},m(o,i){L(o,t,i),h(t,s),h(t,r)},p(o,i){i&1&&n!==(n=o[1].content+"")&&ie(s,n)},d(o){o&&E(t)}}}function mt(e){let t,n=e[1].content+"",s,r;return{c(){t=_("div"),s=F(n),r=C(),g(t,"class","user svelte-kyf5i9")},m(o,i){L(o,t,i),h(t,s),h(t,r)},p(o,i){i&1&&n!==(n=o[1].content+"")&&ie(s,n)},d(o){o&&E(t)}}}function Se(e){let t;function n(o,i){if(o[1].role==="user")return mt;if(o[1].role==="assistant")return pt}let s=n(e),r=s&&s(e);return{c(){r&&r.c(),t=Xe()},m(o,i){r&&r.m(o,i),L(o,t,i)},p(o,i){s===(s=n(o))&&r?r.p(o,i):(r&&r.d(1),r=s&&s(o),r&&(r.c(),r.m(t.parentNode,t)))},d(o){o&&E(t),r&&r.d(o)}}}function ht(e){let t,n=se(e[0]),s=[];for(let r=0;r<n.length;r+=1)s[r]=Se(ke(e,n,r));return{c(){t=_("div");for(let r=0;r<s.length;r+=1)s[r].c();g(t,"class","svelte-kyf5i9")},m(r,o){L(r,t,o);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(t,null)},p(r,[o]){if(o&1){n=se(r[0]);let i;for(i=0;i<n.length;i+=1){const l=ke(r,n,i);s[i]?s[i].p(l,o):(s[i]=Se(l),s[i].c(),s[i].m(t,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=n.length}},i:b,o:b,d(r){r&&E(t),Ie(s,r)}}}function gt(e,t,n){let s;return Y(e,le,r=>n(0,s=r)),[s]}class _t extends J{constructor(t){super(),K(this,t,gt,ht,M,{})}}const Te="http://localhost:11434",yt=async()=>(await fetch(`${Te}/api/tags`)).json(),$t=async()=>{console.log("Refreshing models");const e=await yt();W.set(e.models),console.log("Models: ",Ne(W))},bt=async e=>{const t={role:"user",content:e};return le.update(s=>(s.push(t),s)),(await fetch(`${Te}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:Ne(ge).name,stream:!1,messages:[t]})})).json()},vt=async e=>await bt(e);function wt(e){let t,n,s,r,o,i;return{c(){t=_("div"),n=_("textarea"),s=C(),r=_("button"),r.textContent="Send",g(n,"class","has-text-light has-background-black-ter svelte-wcovc7"),g(n,"placeholder","Type a message..."),g(r,"class","button is-primary svelte-wcovc7"),g(t,"class","container svelte-wcovc7")},m(l,u){L(l,t,u),h(t,n),e[3](n),h(t,s),h(t,r),o||(i=[ee(n,"keypress",e[2]),ee(r,"click",e[1])],o=!0)},p:b,i:b,o:b,d(l){l&&E(t),e[3](null),o=!1,N(i)}}}function kt(e,t,n){let s;async function r(){let l=s.value;if(l&&l.trim()!==""){n(0,s.value="",s);var u=await vt(l);console.log("RESULT: ",u.message),le.update(c=>(c.push(u.message),c))}}function o(l){l.key==="Enter"&&l.ctrlKey&&(r(),l.preventDefault())}Pe(()=>{s.focus()});function i(l){fe[l?"unshift":"push"](()=>{s=l,n(0,s)})}return[s,r,o,i]}class St extends J{constructor(t){super(),K(this,t,kt,wt,M,{})}}function xe(e,{delay:t=0,duration:n=400,easing:s=Le}={}){const r=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:s,css:o=>`opacity: ${o*r}`}}function Ee(e,t,n){const s=e.slice();return s[7]=t[n],s[9]=n,s}function Oe(e){let t,n=e[7].name+"",s,r,o;function i(){return e[5](e[9])}return{c(){t=_("a"),s=F(n),g(t,"class","dropdown-item")},m(l,u){L(l,t,u),h(t,s),r||(o=ee(t,"click",i),r=!0)},p(l,u){e=l,u&4&&n!==(n=e[7].name+"")&&ie(s,n)},d(l){l&&E(t),r=!1,o()}}}function xt(e){var j;let t,n,s,r,o=(((j=e[1])==null?void 0:j.name)||"--")+"",i,l,u,c,f,a,y,w,p,k,v=se(e[2]),$=[];for(let m=0;m<v.length;m+=1)$[m]=Oe(Ee(e,v,m));return{c(){t=_("div"),n=_("div"),s=_("button"),r=_("span"),i=F(o),l=C(),u=_("span"),u.innerHTML='<i class="fas fa-angle-down" aria-hidden="true"></i>',c=C(),f=_("div"),a=_("div");for(let m=0;m<$.length;m+=1)$[m].c();g(u,"class","icon is-small"),g(s,"class","button svelte-g2jfds"),g(s,"aria-haspopup","true"),g(s,"aria-controls","dropdown-menu"),g(n,"class","dropdown-trigger svelte-g2jfds"),g(a,"class","dropdown-content"),g(f,"class","dropdown-menu"),g(f,"role","menu"),g(t,"class","model-list dropdown svelte-g2jfds"),$e(t,"is-active",e[0])},m(m,O){L(m,t,O),h(t,n),h(n,s),h(s,r),h(r,i),h(s,l),h(s,u),h(t,c),h(t,f),h(f,a);for(let x=0;x<$.length;x+=1)$[x]&&$[x].m(a,null);w=!0,p||(k=ee(n,"click",e[4]),p=!0)},p(m,[O]){var x;if((!w||O&2)&&o!==(o=(((x=m[1])==null?void 0:x.name)||"--")+"")&&ie(i,o),O&12){v=se(m[2]);let S;for(S=0;S<v.length;S+=1){const _e=Ee(m,v,S);$[S]?$[S].p(_e,O):($[S]=Oe(_e),$[S].c(),$[S].m(a,null))}for(;S<$.length;S+=1)$[S].d(1);$.length=v.length}(!w||O&1)&&$e(t,"is-active",m[0])},i(m){w||(m&&Q(()=>{w&&(y||(y=we(f,xe,{},!0)),y.run(1))}),w=!0)},o(m){m&&(y||(y=we(f,xe,{},!1)),y.run(0)),w=!1},d(m){m&&E(t),Ie($,m),m&&y&&y.end(),p=!1,k()}}}function Et(e,t,n){let s,r,o;Y(e,re,f=>n(6,s=f)),Y(e,ge,f=>n(1,r=f)),Y(e,W,f=>n(2,o=f));let i=!1;function l(f){Ke(re,s=f,s),n(0,i=!1)}return window.addEventListener("keydown",f=>{f.key==="Escape"&&n(0,i=!1)}),[i,r,o,l,()=>n(0,i=!i),f=>l(f)]}class Ot extends J{constructor(t){super(),K(this,t,Et,xt,M,{})}}function Lt(e){let t,n,s,r,o,i,l,u,c,f;return s=new Ot({}),i=new _t({}),c=new St({}),{c(){t=_("div"),n=_("div"),X(s.$$.fragment),r=C(),o=_("div"),X(i.$$.fragment),l=C(),u=_("div"),X(c.$$.fragment),g(n,"class","model-list svelte-y87zo7"),g(o,"class","content has-background-black-ter svelte-y87zo7"),g(u,"class","chat-input svelte-y87zo7"),g(t,"class","container svelte-y87zo7")},m(a,y){L(a,t,y),h(t,n),q(s,n,null),h(t,r),h(t,o),q(i,o,null),h(t,l),h(t,u),q(c,u,null),f=!0},p:b,i(a){f||(R(s.$$.fragment,a),R(i.$$.fragment,a),R(c.$$.fragment,a),f=!0)},o(a){V(s.$$.fragment,a),V(i.$$.fragment,a),V(c.$$.fragment,a),f=!1},d(a){a&&E(t),B(s),B(i),B(c)}}}function Ct(e){return[]}class Nt extends J{constructor(t){super(),K(this,t,Ct,Lt,M,{})}}function Mt(e){let t;return{c(){t=_("button"),t.textContent="Click me",g(t,"class","button is-prmiary is-small")},m(n,s){L(n,t,s)},p:b,i:b,o:b,d(n){n&&E(t)}}}class jt extends J{constructor(t){super(),K(this,t,null,Mt,M,{})}}const Re="CHIT",At=[],qe=["model_settings"];function It(e){return localStorage.getItem(Re+"_"+e)}function Pt(){Object.keys(D).filter(e=>!qe.includes(e)).forEach(e=>{D[e].constructor=="Array"||At.push(D[e].subscribe(t=>{localStorage.setItem(Re+"_"+e,JSON.stringify(t))}))})}function zt(){console.debug("Attempting to restore local storage stores..."),Object.keys(D).filter(e=>!qe.includes(e)).forEach(e=>{var n;const t=It(e);t&&((n=D[e])!=null&&n.set)&&D[e].set(JSON.parse(t))})}async function Tt(){console.log("Initializing app..."),zt(),Pt(),await $t(),console.log("...init complete.")}function Rt(e){let t,n,s,r,o,i,l;return s=new jt({}),i=new Nt({}),{c(){t=_("div"),n=_("div"),X(s.$$.fragment),r=C(),o=_("div"),X(i.$$.fragment),g(n,"class","sidebar has-background-black-ter svelte-ollw6u"),g(o,"class","content svelte-ollw6u"),g(t,"class","container svelte-ollw6u")},m(u,c){L(u,t,c),h(t,n),q(s,n,null),h(t,r),h(t,o),q(i,o,null),l=!0},p:b,i(u){l||(R(s.$$.fragment,u),R(i.$$.fragment,u),l=!0)},o(u){V(s.$$.fragment,u),V(i.$$.fragment,u),l=!1},d(u){u&&E(t),B(s),B(i)}}}function qt(e){return Pe(async()=>{console.log("onMount"),await Tt()}),[]}class Bt extends J{constructor(t){super(),K(this,t,qt,Rt,M,{})}}new Bt({target:document.body});
